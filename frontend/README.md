# 租房协商系统前端

基于LangGraph流式控制器的租客-房东自动协商系统，提供实时对话流和直观的用户界面。

## 功能特点

- **实时流式对话** - 基于WebSocket的实时消息流，支持LangGraph流式输出
- **多会话管理** - 同时管理多个租客-房东协商会话
- **自动匹配系统** - 为租客自动匹配最合适的房产和房东
- **直观的聊天界面** - 模拟真实对话的直观交互界面
- **系统状态监控** - 实时查看系统统计信息和会话状态

## 文件结构

- `rental_app.py` - 主应用程序，包含Streamlit UI和系统逻辑
- `rental_websocket_client.py` - 优化版WebSocket客户端和消息管理器
- `start_rental_app.sh` - 启动脚本

## 如何使用

1. 确保后端服务正在运行：

   ```bash
   cd backend
   python -m app.api_service.main
   ```

2. 使用启动脚本运行前端：

   ```bash
   cd frontend
   ./start_rental_app.sh
   ```

3. 在浏览器中访问 `http://localhost:8501`

## 系统功能

### 启动新会话

在侧边栏中设置租客数量（1-20），然后点击「开始协商」按钮。系统将自动：

1. 创建指定数量的租客
2. 为每个租客匹配合适的房东和房产
3. 启动自动协商对话

### 实时对话

- 每个会话标签页显示租客和房东之间的对话
- 对话会自动进行，无需人工干预
- 可以看到消息的实时流式输出

### 手动操作

- 「手动发送消息」功能允许您以任一方身份发送消息
- 「停止协商」按钮停止所有自动对话
- 「重置内存」清除系统状态

## 技术实现

- **WebSocket管理** - 高效的连接池和消息处理
- **消息缓冲** - 智能的消息管理和显示
- **线程安全设计** - 确保多线程环境下的稳定运行
- **自动重连机制** - 在连接断开时自动重新连接
- **流式处理** - 支持LangGraph的流式输出功能

## 系统要求

- Python 3.10+
- Streamlit
- Websockets
- Requests
